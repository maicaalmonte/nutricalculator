<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mainutrifox</title>

    <!-- Google Translate API -->
    <script type="text/javascript">
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({
                pageLanguage: 'en',
                includedLanguages: 'en,es,fr,de,it,pt', // Add the languages you want
                layout: google.translate.TranslateElement.InlineLayout.SIMPLE
            }, 'google_translate_element');
        }
    </script>
    <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #d4ff94; }
        input, button { margin: 5px; padding: 10px; font-size: 14px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; background-color: #ffd4fa; }
        table, th, td { border: 1px solid #ccc; }
        th, td { padding: 10px; text-align: left; }
        th { background-color: #d1b2eb; font-weight: bold; }
        .calculator { margin-top: 20px; padding: 10px; background-color: #324232; border-radius: 5px; }
        .calculator label, .calculator input { margin-right: 8px; }
        .calculator div { display: inline-block; margin-right: 15px; }
        .status { color: red; margin: 10px 0; }
        .nutrition-results { margin-top: 20px; background-color: #d1b2eb; padding: 15px; border-radius: 5px; }
        .news-section { margin-top: 30px; background-color: #f1f1f1; padding: 15px; border-radius: 5px; }
        .news-article { margin-bottom: 15px; padding: 10px; background-color: #fff; border: 1px solid #ccc; }
        .news-article h3 { margin: 0; font-size: 18px; }
        .news-article p { font-size: 14px; color: #555; }
    </style>
</head>
<body>
    <h1>NUTRITION FACTS CALCULATOR</h1>

    <!-- Google Translate Dropdown -->
    <div id="google_translate_element" style="margin-bottom: 20px;"></div>

    <!-- Filters for Data -->
    <div>
        <label for="page">Page:</label>
        <input type="number" id="page" value="1" min="1">
        <label for="limit">Limit:</label>
        <input type="number" id="limit" value="10" min="1">
        <label for="category">Category:</label>
        <input type="text" id="category" placeholder="e.g., Beverages">
        <label for="brand">Brand:</label>
        <input type="text" id="brand" placeholder="e.g., Coca Cola">
        <label for="product_name">Product Name:</label>
        <input type="text" id="product_name" placeholder="e.g., Diet Coke">
        <button onclick="fetchData()">Fetch Data</button>
    </div>

    <!-- Status Message -->
    <div id="status" class="status"></div>

    <!-- News Section -->
    <div class="news-section">
        <h2>Latest News</h2>
        <div id="news-articles">
            <!-- Placeholder for news articles -->
        </div>
        <button onclick="fetchNews()">Fetch More News</button>
    </div>

    <!-- Nutrition Calculator -->
    <div class="calculator">
        <div>
            <label for="products">SELECT PRODUCTS (comma separated):</label>
            <input type="text" id="products" placeholder="e.g., Coca-Cola, Nutella">
        </div>
        <div>
            <label for="quantities">QUANTITIES (comma separated, e.g., ml or g):</label>
            <input type="text" id="quantities" placeholder="e.g., 100ml, 50g">
        </div>
        <div>
            <button onclick="calculateNutrition()">CALCULATE NUTRITION</button>
        </div>
        <div id="calculated-nutrition" class="nutrition-results"></div>
    </div>

    <!-- Data Table -->
    <table id="data-table">
        <thead>
            <tr>
                <th>Product Name</th>
                <th>Brand</th>
                <th>Ingredients</th>
                <th>Quantity</th>
                <th>Code</th>
                <th>Energy (kcal/100g)</th>
                <th>Fat (g/100g)</th>
                <th>Carbohydrates (g/100g)</th>
                <th>Sugars (g/100g)</th>
                <th>Proteins (g/100g)</th>
                <th>Salt (g/100g)</th>
                <th>Fiber (g/100g)</th>
                <th>Vitamin A (µg/100g)</th>
                <th>Vitamin C (mg/100g)</th>
                <th>Calcium (mg/100g)</th>
                <th>Iron (mg/100g)</th>
                <th>Magnesium (mg/100g)</th>
                <th>Potassium (mg/100g)</th>
                <th>Sodium (mg/100g)</th>
                <th>Zinc (mg/100g)</th>
                <th>Phosphorus (mg/100g)</th>
                <th>Vitamin D (µg/100g)</th>
                <th>Vitamin E (mg/100g)</th>
                <th>Vitamin K (µg/100g)</th>
                <th>Folate (µg/100g)</th>
                <th>Vitamin B12 (µg/100g)</th>
                <th>Vitamin B6 (mg/100g)</th>
                <th>Copper (mg/100g)</th>
                <th>Manganese (mg/100g)</th>
                <th>Selenium (µg/100g)</th>
            </tr>
        </thead>
        <tbody>
            <!-- Data will be injected here -->
        </tbody>
    </table>

    <script>
        let productData = [];  // Store product data

        async function fetchData() {
            const page = document.getElementById('page').value;
            const limit = document.getElementById('limit').value;
            const category = document.getElementById('category').value;
            const brand = document.getElementById('brand').value;
            const product_name = document.getElementById('product_name').value;
            const statusDiv = document.getElementById('status');
            const tableBody = document.getElementById('data-table').querySelector('tbody');

            statusDiv.textContent = '';
            tableBody.innerHTML = '';

            try {
                const response = await fetch('/fetch_data', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        page,
                        limit,
                        category,
                        brand,
                        product_name
                    })
                });

                const data = await response.json();
                if (data.status === 'success') {
                    productData = data.data;

                    productData.forEach(product => {
                        const row = document.createElement('tr');
                        Object.values(product).forEach(value => {
                            const cell = document.createElement('td');
                            cell.textContent = value;
                            row.appendChild(cell);
                        });
                        tableBody.appendChild(row);
                    });
                } else {
                    statusDiv.textContent = data.message;
                }
            } catch (error) {
                statusDiv.textContent = 'Error fetching data.';
                console.error('Error:', error);
            }
        }

        // Function to fetch and display news
        async function fetchNews() {
            try {
                const response = await fetch('/fetch_news');
                const data = await response.json();

                const newsContainer = document.getElementById('news-articles');
                newsContainer.innerHTML = '';

                if (data.status === 'success') {
                    data.articles.slice(0, 3).forEach(article => {
                        const articleDiv = document.createElement('div');
                        articleDiv.classList.add('news-article');
                        articleDiv.innerHTML = `
                            <h3>${article.title}</h3>
                            <p>${article.description || 'No description available.'}</p>
                            <a href="${article.url}" target="_blank">Read more</a>
                        `;
                        newsContainer.appendChild(articleDiv);
                    });
                } else {
                    newsContainer.textContent = 'Error fetching news.';
                }
            } catch (error) {
                console.error('Error fetching news:', error);
            }
        }

        // Function to calculate nutrition
        function calculateNutrition() {
            const productsInput = document.getElementById('products').value.split(',').map(p => p.trim());
            const quantitiesInput = document.getElementById('quantities').value.split(',').map(q => q.trim());

            // Clear previous results
            const resultsDiv = document.getElementById('calculated-nutrition');
            resultsDiv.innerHTML = '';

            if (productsInput.length !== quantitiesInput.length) {
                resultsDiv.textContent = 'Please make sure the number of products and quantities match.';
                return
